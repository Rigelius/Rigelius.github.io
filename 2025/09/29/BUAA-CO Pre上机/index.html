<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>BUAA-CO Pre上机 | Rigelius Blog</title><meta name="author" content="Rigelius"><meta name="copyright" content="Rigelius"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="本节主要是掌握三个工具，三道题目依次为 Logisim、Verilog、MIPS。 课上题目 T1 推箱子 任务描述 我们需要在 Logisim 中设计一个软电路来模拟简易的推箱子游戏。游戏地图构建在一个二维平面直角坐标系中，范围是 \(0 \le x, y \le 5\) 的正方形区域（共 \(6 \times 6\) 个点）。 箱子的起始位置（包括 Reset 后）固定在 \(">
<meta property="og:type" content="article">
<meta property="og:title" content="BUAA-CO Pre上机">
<meta property="og:url" content="https://rigelius.github.io/2025/09/29/BUAA-CO%20Pre%E4%B8%8A%E6%9C%BA/index.html">
<meta property="og:site_name" content="Rigelius Blog">
<meta property="og:description" content="本节主要是掌握三个工具，三道题目依次为 Logisim、Verilog、MIPS。 课上题目 T1 推箱子 任务描述 我们需要在 Logisim 中设计一个软电路来模拟简易的推箱子游戏。游戏地图构建在一个二维平面直角坐标系中，范围是 \(0 \le x, y \le 5\) 的正方形区域（共 \(6 \times 6\) 个点）。 箱子的起始位置（包括 Reset 后）固定在 \(">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://rigelius.github.io/img/background.jpg">
<meta property="article:published_time" content="2025-09-29T14:00:00.000Z">
<meta property="article:modified_time" content="2026-02-12T16:15:14.051Z">
<meta property="article:author" content="Rigelius">
<meta property="article:tag" content="CO">
<meta property="article:tag" content="Logisim">
<meta property="article:tag" content="MIPS">
<meta property="article:tag" content="Verilog">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://rigelius.github.io/img/background.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "BUAA-CO Pre上机",
  "url": "https://rigelius.github.io/2025/09/29/BUAA-CO%20Pre%E4%B8%8A%E6%9C%BA/",
  "image": "https://rigelius.github.io/img/background.jpg",
  "datePublished": "2025-09-29T14:00:00.000Z",
  "dateModified": "2026-02-12T16:15:14.051Z",
  "author": [
    {
      "@type": "Person",
      "name": "Rigelius",
      "url": "https://Rigelius.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://rigelius.github.io/2025/09/29/BUAA-CO%20Pre%E4%B8%8A%E6%9C%BA/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'BUAA-CO Pre上机',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"></head><body><div class="bg-animation" id="web_bg" style="background-color: #f0f0f0;"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 目录</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/friends/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/background.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Rigelius Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">BUAA-CO Pre上机</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><span class="site-page custom-search-btn"><i class="fa-fw fas fa-search"></i><span> Search</span></span></div><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 目录</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/friends/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><span class="site-page custom-theme-toggle"><i class="fa-fw fas fa-moon"></i></span></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">BUAA-CO Pre上机</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-09-29T14:00:00.000Z" title="发表于 2025-09-29 22:00:00">2025-09-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-02-12T16:15:14.051Z" title="更新于 2026-02-13 00:15:14">2026-02-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/">计算机组成</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>本节主要是掌握三个工具，三道题目依次为 Logisim、Verilog、MIPS。</p>
<h2 id="课上题目">课上题目</h2>
<h3 id="t1-推箱子">T1 推箱子</h3>
<h4 id="任务描述">任务描述</h4>
<p>我们需要在 Logisim
中设计一个软电路来模拟简易的推箱子游戏。游戏地图构建在一个二维平面直角坐标系中，范围是
<span class="math inline">\(0 \le x, y \le 5\)</span> 的正方形区域（共
<span class="math inline">\(6 \times 6\)</span> 个点）。</p>
<p>箱子的<strong>起始位置</strong>（包括 Reset 后）固定在 <span
class="math inline">\((0,0)\)</span>，<strong>目标位置</strong>固定在
<span class="math inline">\((5,5)\)</span>。</p>
<p>地图中包含 6 个固定的<strong>障碍点</strong>，分别为：<span
class="math inline">\((1,1)\)</span>、<span
class="math inline">\((1,2)\)</span>、<span
class="math inline">\((2,1)\)</span>、<span
class="math inline">\((3,4)\)</span>、<span
class="math inline">\((4,3)\)</span>、<span
class="math inline">\((4,4)\)</span>。</p>
<h4 id="控制逻辑">控制逻辑</h4>
<p>系统输入 <span class="math inline">\((dx, dy)\)</span>
表示箱子的移动变化量，且保证只会出现 <span
class="math inline">\((0,0)\)</span>、<span
class="math inline">\((1,0)\)</span> 或 <span
class="math inline">\((0,1)\)</span> 这三种情况。</p>
<p>设当前坐标为 <span class="math inline">\((x,
y)\)</span>，则预期坐标为 <span class="math inline">\((x+dx,
y+dy)\)</span>：</p>
<ul>
<li>如果预期坐标<strong>合法</strong>（即在地图边界内且不是障碍），则在下一周期将箱子移动到该位置；</li>
<li>如果预期坐标<strong>非法</strong>（越界或撞墙），则箱子保持原地不动，并将报错信号
<code>flag</code> 置为 1（持续一个周期）。</li>
</ul>
<h4 id="输出判定">输出判定</h4>
<ul>
<li>当箱子成功到达目标点 <span class="math inline">\((5,5)\)</span>
时，输出信号 <code>out</code> 为 1，否则为 0。</li>
<li><code>flag</code> 信号默认为 0，仅在尝试非法移动时置为 1。</li>
</ul>
<h4 id="接口列表">接口列表</h4>
<ul>
<li><strong>输入</strong>：<code>clk</code> (时钟), <code>reset</code>
(复位), <code>dx</code> (x位移), <code>dy</code> (y位移)</li>
<li><strong>输出</strong>：<code>out</code> (到达目标),
<code>flag</code> (非法移动报错)</li>
</ul>
<h3 id="t2-翻涌数字">T2 翻涌数字</h3>
<h4 id="题目描述">题目描述</h4>
<p>将 32 位输入 <span class="math inline">\(a\)</span> 视为 8 个 4
位宽的数，分别命名为 <span class="math inline">\(a_0, a_1, \dots,
a_7\)</span>（其中<span class="math inline">\(a_i = a[(i + 1) \cdot 4 -
1 : i \cdot 4]\)</span>）。</p>
<p>对每一个 <span class="math inline">\(a_i\)</span>
进行前缀和计算，公式如下：</p>
<p><span class="math display">\[a_i = \sum_{j=0}^{i} a_j\]</span></p>
<h4 id="计算规则">计算规则</h4>
<ul>
<li><strong>溢出处理</strong>：若累加结果超过 4 位，仅保留低 4 位（即对
16 取模）。</li>
<li><strong>输出格式</strong>：将计算后的 <span
class="math inline">\(a_i\)</span> 按原顺序拼接，作为 32 位输出
<code>out</code>。</li>
</ul>
<h4 id="样例">样例</h4>
<ul>
<li><p><strong>输入</strong>：<code>32'h11111111</code></p></li>
<li><p><strong>输出</strong>：<code>32'h87654321</code></p></li>
</ul>
<h4 id="接口列表-1">接口列表</h4>
<ul>
<li><strong>输入</strong>：<code>a[31:0]</code></li>
<li><strong>输出</strong>：<code>out[31:0]</code></li>
</ul>
<h3 id="t3-子矩阵提取">T3 子矩阵提取</h3>
<h4 id="题目描述-1">题目描述</h4>
<p>编写 MIPS 汇编程序，从一个 <span class="math inline">\(4 \times
4\)</span> 的大矩阵 <span class="math inline">\(A\)</span> 中，提取以
<span class="math inline">\((i, j)\)</span> 为左上角、大小为 <span
class="math inline">\(m \times n\)</span> 的子矩阵。</p>
<h4 id="输入格式">输入格式</h4>
<p>输入共 20 行，均通过 <code>syscall</code> 读取整数：</p>
<ul>
<li><strong>第 1-16 行</strong>：依次输入大矩阵 <span
class="math inline">\(A\)</span> 的元素 <span
class="math inline">\(t\)</span>（按行优先顺序，即第 0 行第 0 列、第 0
行第 1 列……）。</li>
<li><strong>第 17 行</strong>：子矩阵行数 <span
class="math inline">\(m\)</span> (<span class="math inline">\(1 \le m
\le 4\)</span>)。</li>
<li><strong>第 18 行</strong>：子矩阵列数 <span
class="math inline">\(n\)</span> (<span class="math inline">\(1 \le n
\le 4\)</span>)。</li>
<li><strong>第 19 行</strong>：起始行坐标 <span
class="math inline">\(i\)</span> (<span class="math inline">\(0 \le i
\le 3\)</span>)。</li>
<li><strong>第 20 行</strong>：起始列坐标 <span
class="math inline">\(j\)</span> (<span class="math inline">\(0 \le j
\le 3\)</span>)。</li>
</ul>
<h4 id="输出格式">输出格式</h4>
<ul>
<li><strong>合法提取</strong>：输出 <span class="math inline">\(m \times
n\)</span> 的子矩阵。共 <span class="math inline">\(m\)</span> 行，每行
<span class="math inline">\(n\)</span> 个元素，元素间用空格分隔。</li>
<li><strong>越界报错</strong>：若子矩阵超出大矩阵边界，仅输出字符串
<code>Out of bounds</code>。</li>
</ul>
<h4 id="约定与约束">约定与约束</h4>
<ul>
<li><p>矩阵索引从 0 开始。</p></li>
<li><p>请勿使用 <code>.globl main</code>。</p></li>
<li><p>程序结束时必须使用以下代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">li $v0, 10</span><br><span class="line">syscall</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>测试样例</strong></p>
<ul>
<li><p><strong>样例 1</strong></p>
<ul>
<li><p><strong>Input</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">2</span><br><span class="line">2</span><br><span class="line">1</span><br><span class="line">1</span><br></pre></td></tr></table></figure></li>
<li><p><strong>Output</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">6 7</span><br><span class="line">10 11</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li><p><strong>样例 2</strong></p>
<ul>
<li><p><strong>Input</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">4</span><br><span class="line">3</span><br><span class="line">2</span><br><span class="line">1</span><br><span class="line">8</span><br><span class="line">7</span><br><span class="line">6</span><br><span class="line">5</span><br><span class="line">12</span><br><span class="line">11</span><br><span class="line">10</span><br><span class="line">9</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">3</span><br><span class="line">2</span><br><span class="line">2</span><br><span class="line">2</span><br></pre></td></tr></table></figure></li>
<li><p><strong>Output</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Out of bounds</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul>
<h2 id="题目分析">题目分析</h2>
<p>T1
是状态机问题，题干可能看上去比较新颖。一定不要自己搭组合电路，而是用
Logisim 的 <code>Analyze Circuit</code>
功能，输入真值表，自动产生对应的组合电路。还有可以多多利用 Logisim
的子电路功能，将具体的组合逻辑放到子电路，从而使顶端模块清爽、简洁。还要注意
<code>flag</code> 置 1 要持续一周期，因此在它前面还要加一个寄存器。</p>
<p>T2 比较简单，使用 <code>for</code> 循环即可，但是 <code>for</code>
循环似乎很多人都忘了怎么写了（也包括我在内），不用循环的话直接展开也不难。还有如果定义成
4 位的变量，Verilog 似乎默认会自动取模，因此模 16 也可以不写。</p>
<p>T3 中规中矩，一定要多利用宏，例如
<code>readInt</code>、<code>printInt</code>、<code>printStr</code>
等，<code>for</code>
循环也可以封装成宏。但本题我犯了一个错误：我定义了一个
<code>printStr</code> 宏函数，这个函数会在内部在 <code>.data</code>
段中定义一个字符串，可能是由于字节不对齐的原因，使用这个函数后之后的地址可能不是
4 的整数倍，因此程序不能正确运行，修改后就成功 AC
了。因此尽量不要在函数内部定义字符串，而是在 <code>.data</code>
里面定义好，并且先定义数组，再定义字符串，就可以尽量避免这种字节不对齐的问题。</p>
<h2 id="笔者的话">笔者的话</h2>
<p>Pre
上机不占分，主要是熟悉一下形式，这次是只有做出三道才算通过，建议上机前再读一遍指导书，基本的知识点要牢记，比如状态机设计、Verilog
中 <code>for</code> 循环的写法、MIPS 编程等等。还有，前几次上机 21:00
后还可以继续做到 22:00，同时可以查看每道题的提示，因此不用太过担心。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://Rigelius.github.io">Rigelius</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://rigelius.github.io/2025/09/29/BUAA-CO%20Pre%E4%B8%8A%E6%9C%BA/">https://rigelius.github.io/2025/09/29/BUAA-CO%20Pre%E4%B8%8A%E6%9C%BA/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://Rigelius.github.io" target="_blank">Rigelius Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MIPS/">MIPS</a><a class="post-meta__tags" href="/tags/CO/">CO</a><a class="post-meta__tags" href="/tags/Logisim/">Logisim</a><a class="post-meta__tags" href="/tags/Verilog/">Verilog</a></div><div class="post-share"><div class="social-share" data-image="/img/background.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/10/13/BUAA-CO%20P0%E4%B8%8A%E6%9C%BA/" title="BUAA-CO P0上机"><img class="cover" src="/img/background.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">BUAA-CO P0上机</div></div><div class="info-2"><div class="info-item-1">本节考查内容为 Logisim，一般是一道组合逻辑和两道时序逻辑，时序逻辑中一个是有限状态机。 课上题目 T1 起伏数列 任务描述 我们需要在 Logisim 中设计一个 Moore 型有限状态机，用于实时监测输入数列的波动趋势。输入 \(a\) 为 5 位无符号整数。 数列的初始值默认为 \(a_0 = 7\)。即复位后，读入的第一个数据 \(a_1\) 将与 7 进行比较。 判定逻辑 设当前输入为 \(a_{m}\)，上一周期输入为 \(a_{m-1}\)（题目保证相邻输入不相等）：  若 \(a_{m} &gt; a_{m-1}\)，记为“起”； 若 \(a_{m} &lt; a_{m-1}\)，记为“伏”。  我们需要检测的目标模式是 “起 \(\rightarrow\) 起 \(\rightarrow\) 伏 \(\rightarrow\) 起”。 状态机支持循环检测，即当前成功匹配序列的最后一个“起”，可以作为下一个序列的开头。 当且仅当最近四个周期的变化趋势严格满足“起起伏起”时，输出 output 为 1，其他情况 out...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/10/13/BUAA-CO%20P0%E4%B8%8A%E6%9C%BA/" title="BUAA-CO P0上机"><img class="cover" src="/img/background.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-13</div><div class="info-item-2">BUAA-CO P0上机</div></div><div class="info-2"><div class="info-item-1">本节考查内容为 Logisim，一般是一道组合逻辑和两道时序逻辑，时序逻辑中一个是有限状态机。 课上题目 T1 起伏数列 任务描述 我们需要在 Logisim 中设计一个 Moore 型有限状态机，用于实时监测输入数列的波动趋势。输入 \(a\) 为 5 位无符号整数。 数列的初始值默认为 \(a_0 = 7\)。即复位后，读入的第一个数据 \(a_1\) 将与 7 进行比较。 判定逻辑 设当前输入为 \(a_{m}\)，上一周期输入为 \(a_{m-1}\)（题目保证相邻输入不相等）：  若 \(a_{m} &gt; a_{m-1}\)，记为“起”； 若 \(a_{m} &lt; a_{m-1}\)，记为“伏”。  我们需要检测的目标模式是 “起 \(\rightarrow\) 起 \(\rightarrow\) 伏 \(\rightarrow\) 起”。 状态机支持循环检测，即当前成功匹配序列的最后一个“起”，可以作为下一个序列的开头。 当且仅当最近四个周期的变化趋势严格满足“起起伏起”时，输出 output 为 1，其他情况 out...</div></div></div></a><a class="pagination-related" href="/2025/12/01/BUAA-CO%20P6%E4%B8%8A%E6%9C%BA/" title="BUAA-CO P6上机"><img class="cover" src="/img/background.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-01</div><div class="info-item-2">BUAA-CO P6上机</div></div><div class="info-2"><div class="info-item-1">本节考查内容为 Verilog 实现流水线 CPU。 第一次课上题目 T1 mygo mygo-rs-rt RTL 123456789101112131415161718192021222324function pattern_value(g):    return count_leading_zeros(g) * 2 + count_ones(g)function characteristic_code(A):    sum &lt;- 0    for i in 0..7:        g &lt;- A[4*i+3 : 4*i]        sum &lt;- sum + pattern_value(g) * (i + 1)    return sum    MDU_Start(Busy_Cycles = 5)temp1 &lt;- characteristic_code(GPR[rs])temp2 &lt;- characteristic_code(GPR[rt])if (temp1 &gt; temp2)    HI &lt;- GPR[rs]    LO...</div></div></div></a><a class="pagination-related" href="/2025/12/08/BUAA-CO%20P7%E4%B8%8A%E6%9C%BA/" title="BUAA-CO P7上机"><img class="cover" src="/img/background.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-08</div><div class="info-item-2">BUAA-CO P7上机</div></div><div class="info-2"><div class="info-item-1">本节考查内容为 Verilog 实现 MIPS 微系统，支持中断和异常。 课上题目 T1~T4 都是课下强测，分别是功能强测、异常强测、中断强测、冲突强测。 T5 Monitor 在 P7 系统中（DM 范围 0x0000 ~ 0x2fff），新增一套内存监视控制机制。需在 CP0 中扩展三个专用寄存器，并增加一条专用配置指令 monitor，配合 sw 指令实现对特定内存区间的写入保护。 1. 新增 CP0 寄存器 系统复位后，以下三个寄存器均置为 0。          编号 寄存器名 功能描述 读写权限     18 DMBoundaryHI 监视区间上界 mfc0 可读；仅 monitor 可写   19 DMBoundaryLO 监视区间下界 mfc0 可读；仅 monitor 可写   20 DMEnable 监视使能控制字 mfc0 可读；仅 monitor 可写     mtc0：仅能写入原有的 12-15 号寄存器（SR, Cause, EPC, PrID ），写入...</div></div></div></a><a class="pagination-related" href="/2025/11/03/BUAA-CO%20P3%E4%B8%8A%E6%9C%BA/" title="BUAA-CO P3上机"><img class="cover" src="/img/background.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-03</div><div class="info-item-2">BUAA-CO P3上机</div></div><div class="info-2"><div class="info-item-1">本节考查内容为 Logisim 实现单周期 CPU。 课上题目 T1 revi revi-rs-rt-imm16 RTL 123temp &lt;- GPR[rs]result &lt;- temp[31-imm16:0]||reverse(temp[31:32-imm16])GPR[rt] &lt;- result T2 blz blz-rs-rt-offset RTL 12345678910temp1 &lt;- count_leading_zeros(GPR[rs])temp2 &lt;- count_leading_zeros(GPR[rt])if (temp1 == temp2)     PC &lt;- PC + 4 + sign_ext(offset||00)else if (temp1 &gt; temp2)    PC &lt;- PC + 4    GPR[rs] &lt;- temp1else    PC &lt;- PC + 4    GPR[rs] &lt;- temp2 T3 lwf lwf-base-rt-offset RTL...</div></div></div></a><a class="pagination-related" href="/2025/10/27/BUAA-CO%20P2%E4%B8%8A%E6%9C%BA/" title="BUAA-CO P2上机"><img class="cover" src="/img/background.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-27</div><div class="info-item-2">BUAA-CO P2上机</div></div><div class="info-2"><div class="info-item-1">本节考查内容为 MIPS 汇编语言，三道题目一般至少两道会给参考 C 代码，考验 MIPS 代码的编写能力。 课上题目 T1 工厂选址 任务描述 假设你正在编写城市规划核心功能。需要在给定的 \(n\) 个候选坐标点 \((x, y)\) 中，筛选出一个符合特定条件的点用于建造工厂。 筛选条件：  象限限制：候选点必须位于平面直角坐标系的 第二象限 或 第四象限（不包含坐标轴）。 面积最大化：该点向两坐标轴作垂线，与原点 \((0,0)\) 所围成的矩形面积必须是所有满足条件点中最大的。  你需要编写 MIPS 汇编程序实现该逻辑，输出选定点的坐标。 判定逻辑 有效性判定： 对于输入坐标 \((x, y)\)，该点有效当且仅当满足以下二者之一：  第二象限：\(x &lt; 0\) 且 \(y &gt; 0\) 第四象限：\(x &gt; 0\) 且 \(y &lt; 0\) 注：位于第一、三象限或坐标轴上的点应直接忽略。  优化目标： 计算矩形面积 \(Area = |x| \times |y|\)。  若存在多个点的面...</div></div></div></a><a class="pagination-related" href="/2025/11/17/BUAA-CO%20P5%E4%B8%8A%E6%9C%BA/" title="BUAA-CO P5上机"><img class="cover" src="/img/background.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-17</div><div class="info-item-2">BUAA-CO P5上机</div></div><div class="info-2"><div class="info-item-1">本节考查内容为 Verilog 实现流水线 CPU。 课上题目 T1 ccc ccc-rs-rt-rd RTL 123456temp1 &lt;- count_leading_zeros(GPR[rs])temp2 &lt;- count_leading_ones(GPR[rt])if (temp1 &gt; temp2)    GPR[rd] &lt;- GPR[rs][31:16] || GPR[rt][15:0]else    GPR[rd] &lt;- GPR[rt][31:16] || GPR[rs][15:0] T2 cjoc cjoc-rs-rt-offset RTL 123456789ext_offset &lt;- sign_ext(offset||00)id &lt;- ext_offset[4:2]temp &lt;- GPR[rs][id + 7 : id]condition &lt;- (temp &gt; 8&#x27;d21)if (condition)    GPR[rt] &lt;- PC + 8    PC &lt;- PC ...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Rigelius</div><div class="author-info-description">A blog about technology and life.</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Rigelius"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BE%E4%B8%8A%E9%A2%98%E7%9B%AE"><span class="toc-number">1.</span> <span class="toc-text">课上题目</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#t1-%E6%8E%A8%E7%AE%B1%E5%AD%90"><span class="toc-number">1.1.</span> <span class="toc-text">T1 推箱子</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1%E6%8F%8F%E8%BF%B0"><span class="toc-number">1.1.1.</span> <span class="toc-text">任务描述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E9%80%BB%E8%BE%91"><span class="toc-number">1.1.2.</span> <span class="toc-text">控制逻辑</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%E5%88%A4%E5%AE%9A"><span class="toc-number">1.1.3.</span> <span class="toc-text">输出判定</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E5%88%97%E8%A1%A8"><span class="toc-number">1.1.4.</span> <span class="toc-text">接口列表</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#t2-%E7%BF%BB%E6%B6%8C%E6%95%B0%E5%AD%97"><span class="toc-number">1.2.</span> <span class="toc-text">T2 翻涌数字</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0"><span class="toc-number">1.2.1.</span> <span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E8%A7%84%E5%88%99"><span class="toc-number">1.2.2.</span> <span class="toc-text">计算规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B7%E4%BE%8B"><span class="toc-number">1.2.3.</span> <span class="toc-text">样例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E5%88%97%E8%A1%A8-1"><span class="toc-number">1.2.4.</span> <span class="toc-text">接口列表</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#t3-%E5%AD%90%E7%9F%A9%E9%98%B5%E6%8F%90%E5%8F%96"><span class="toc-number">1.3.</span> <span class="toc-text">T3 子矩阵提取</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-1"><span class="toc-number">1.3.1.</span> <span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.3.2.</span> <span class="toc-text">输入格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.3.3.</span> <span class="toc-text">输出格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BA%A6%E5%AE%9A%E4%B8%8E%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.3.4.</span> <span class="toc-text">约定与约束</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E5%88%86%E6%9E%90"><span class="toc-number">2.</span> <span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%94%E8%80%85%E7%9A%84%E8%AF%9D"><span class="toc-number">3.</span> <span class="toc-text">笔者的话</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2026/01/16/Math-Test/" title="Math-Test"><img src="/img/background.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Math-Test"/></a><div class="content"><a class="title" href="/2026/01/16/Math-Test/" title="Math-Test">Math-Test</a><time datetime="2026-01-16T11:49:08.000Z" title="发表于 2026-01-16 19:49:08">2026-01-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/16/hello-world/" title="Hello World"><img src="/img/background.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hello World"/></a><div class="content"><a class="title" href="/2026/01/16/hello-world/" title="Hello World">Hello World</a><time datetime="2026-01-16T11:23:16.668Z" title="发表于 2026-01-16 19:23:16">2026-01-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/09/BUAA-CO%20%E6%8E%A8%E8%8D%90%E9%A2%98%E7%9B%AE%E6%B1%87%E6%80%BB/" title="BUAA-CO 推荐题目汇总"><img src="/img/background.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUAA-CO 推荐题目汇总"/></a><div class="content"><a class="title" href="/2025/12/09/BUAA-CO%20%E6%8E%A8%E8%8D%90%E9%A2%98%E7%9B%AE%E6%B1%87%E6%80%BB/" title="BUAA-CO 推荐题目汇总">BUAA-CO 推荐题目汇总</a><time datetime="2025-12-09T14:00:00.000Z" title="发表于 2025-12-09 22:00:00">2025-12-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/08/BUAA-CO%20P7%E4%B8%8A%E6%9C%BA/" title="BUAA-CO P7上机"><img src="/img/background.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUAA-CO P7上机"/></a><div class="content"><a class="title" href="/2025/12/08/BUAA-CO%20P7%E4%B8%8A%E6%9C%BA/" title="BUAA-CO P7上机">BUAA-CO P7上机</a><time datetime="2025-12-08T14:00:00.000Z" title="发表于 2025-12-08 22:00:00">2025-12-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/01/BUAA-CO%20P6%E4%B8%8A%E6%9C%BA/" title="BUAA-CO P6上机"><img src="/img/background.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUAA-CO P6上机"/></a><div class="content"><a class="title" href="/2025/12/01/BUAA-CO%20P6%E4%B8%8A%E6%9C%BA/" title="BUAA-CO P6上机">BUAA-CO P6上机</a><time datetime="2025-12-01T14:00:00.000Z" title="发表于 2025-12-01 22:00:00">2025-12-01</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By Rigelius</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.3</a></span></div></div></footer></div><div class="search-dialog" id="search-modal"><div class="search-dialog-wrapper"><div class="search-dialog-header"><h3 class="search-dialog-title">搜索</h3><button id="search-close" type="button">×</button></div><div class="search-dialog-input-wrap"><label class="search-input-label" for="search-input">关键词</label><input id="search-input" type="text" autocomplete="off"></div><div class="search-results" id="search-results"></div></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.3"></script><script src="/js/main.js?v=5.5.3"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        loader: {
          load: [
            // Four font extension packages (optional)
            //- '[tex]/bbm',
            //- '[tex]/bboldx',
            //- '[tex]/dsfont',
            '[tex]/mhchem'
          ],
          paths: {
            'mathjax-newcm': '[mathjax]/../@mathjax/mathjax-newcm-font',

            //- // Four font extension packages (optional)
            //- 'mathjax-bbm-extension': '[mathjax]/../@mathjax/mathjax-bbm-font-extension',
            //- 'mathjax-bboldx-extension': '[mathjax]/../@mathjax/mathjax-bboldx-font-extension',
            //- 'mathjax-dsfont-extension': '[mathjax]/../@mathjax/mathjax-dsfont-font-extension',
            'mathjax-mhchem-extension': '[mathjax]/../@mathjax/mathjax-mhchem-font-extension'
          }
        },
        output: {
          font: 'mathjax-newcm',
        },
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
          packages: {
            '[+]': [
              'mhchem'
            ]
          }
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          menuOptions: {
            settings: {
              enrich: false  // Turn off Braille and voice narration text automatic generation
            }
          },
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax@4.0.0/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getGiscusTheme = theme => theme === 'dark' ? 'dark' : 'light'

  const createScriptElement = config => {
    const ele = document.createElement('script')
    Object.entries(config).forEach(([key, value]) => {
      ele.setAttribute(key, value)
    })
    return ele
  }

  const loadGiscus = (el = document, key) => {
    const mappingConfig = isShuoshuo
      ? { 'data-mapping': 'specific', 'data-term': key }
      : { 'data-mapping': (option && option['data-mapping']) || 'pathname' }

    const giscusConfig = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'Rigelius/Rigelius.github.io',
      'data-repo-id': 'R_kgDOQ6-aAw',
      'data-category-id': 'DIC_kwDOQ6-aA84C1ESp',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      async: true,
      ...option,
      ...mappingConfig
    }

    const scriptElement = createScriptElement(giscusConfig)

    el.querySelector('#giscus-wrap').appendChild(scriptElement)

    if (isShuoshuo) {
      window.shuoshuoComment.destroyGiscus = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const changeGiscusTheme = theme => {
    const iframe = document.querySelector('#giscus-wrap iframe')
    if (iframe) {
      const message = {
        giscus: {
          setConfig: {
            theme: getGiscusTheme(theme)
          }
        }
      }
      iframe.contentWindow.postMessage(message, 'https://giscus.app')
    }
  }

  btf.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if (isShuoshuo) {
    'Giscus' === 'Giscus'
      ? window.shuoshuoComment = { loadComment: loadGiscus }
      : window.loadOtherComment = loadGiscus
    return
  }

  if ('Giscus' === 'Giscus' || !false) {
    if (false) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment = loadGiscus
  }
})()</script></div><script src="/js/custom.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>